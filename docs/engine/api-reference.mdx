---
title: API Reference
description: Complete REST API reference for StarHash Engine.
---

# API Reference

Complete documentation for all StarHash Engine endpoints.

## Flows

### List Flows

```bash
GET /api/flows
```

Query parameters:

| Param | Type | Description |
|-------|------|-------------|
| `page` | int | Page number (default: 1) |
| `limit` | int | Items per page (default: 20) |
| `search` | string | Search by name |

Response:
```json
{
  "success": true,
  "data": [
    {
      "id": "flow_abc123",
      "name": "Balance Checker",
      "description": "Check account balance",
      "nodeCount": 5,
      "createdAt": "2024-01-15T10:30:00Z",
      "updatedAt": "2024-01-16T14:20:00Z"
    }
  ],
  "meta": {
    "total": 15,
    "page": 1,
    "limit": 20
  }
}
```

### Get Flow

```bash
GET /api/flows/:id
```

Response:
```json
{
  "success": true,
  "data": {
    "id": "flow_abc123",
    "name": "Balance Checker",
    "description": "Check account balance",
    "startNodeId": "node_start",
    "nodes": [
      {
        "id": "node_start",
        "type": "menu",
        "title": "Welcome!",
        "options": [...]
      }
    ],
    "createdAt": "2024-01-15T10:30:00Z",
    "updatedAt": "2024-01-16T14:20:00Z"
  }
}
```

### Create Flow

```bash
POST /api/flows
```

Request:
```json
{
  "name": "My New Flow",
  "description": "A sample USSD flow",
  "startNodeId": "node_1",
  "nodes": [
    {
      "id": "node_1",
      "type": "menu",
      "title": "Welcome!",
      "options": [
        {"label": "Option 1", "nextNodeId": "node_2"},
        {"label": "Exit", "nextNodeId": "node_end"}
      ]
    },
    {
      "id": "node_end",
      "type": "end",
      "message": "Goodbye!"
    }
  ]
}
```

### Update Flow

```bash
PUT /api/flows/:id
```

Request: Same as create.

### Delete Flow

```bash
DELETE /api/flows/:id
```

---

## Instances

### List Instances

```bash
GET /api/instances
```

Query parameters:

| Param | Type | Description |
|-------|------|-------------|
| `flowId` | string | Filter by flow |
| `status` | string | Filter by status (active, paused) |

### Get Instance

```bash
GET /api/instances/:id
```

Response:
```json
{
  "success": true,
  "data": {
    "id": "inst_xyz789",
    "flowId": "flow_abc123",
    "name": "Production",
    "provider": "africas_talking",
    "shortcode": "*123#",
    "status": "active",
    "callbackUrl": "https://api.starhash.dev/hooks/africas_talking/inst_xyz789",
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### Create Instance

```bash
POST /api/instances
```

Request:
```json
{
  "flowId": "flow_abc123",
  "name": "Production",
  "provider": "africas_talking",
  "shortcode": "*123#",
  "config": {
    "username": "sandbox",
    "apiKey": "your-api-key"
  }
}
```

### Update Instance

```bash
PUT /api/instances/:id
```

### Pause Instance

```bash
POST /api/instances/:id/pause
```

### Resume Instance

```bash
POST /api/instances/:id/resume
```

### Delete Instance

```bash
DELETE /api/instances/:id
```

---

## Sessions

### List Sessions

```bash
GET /api/sessions
```

Query parameters:

| Param | Type | Description |
|-------|------|-------------|
| `instanceId` | string | Filter by instance |
| `phone` | string | Filter by phone number |
| `status` | string | Filter by status |
| `from` | datetime | Start date |
| `to` | datetime | End date |
| `page` | int | Page number |
| `limit` | int | Items per page |

Response:
```json
{
  "success": true,
  "data": [
    {
      "id": "sess_abc123",
      "instanceId": "inst_xyz789",
      "phone": "+233201234567",
      "status": "completed",
      "nodeCount": 5,
      "duration": 45000,
      "startedAt": "2024-01-15T10:30:00Z",
      "endedAt": "2024-01-15T10:30:45Z"
    }
  ]
}
```

### Get Session (X-Ray)

```bash
GET /api/sessions/:id
```

Response:
```json
{
  "success": true,
  "data": {
    "id": "sess_abc123",
    "instanceId": "inst_xyz789",
    "phone": "+233201234567",
    "status": "completed",
    "variables": {
      "name": "John",
      "balance": 450.50
    },
    "timeline": [
      {
        "timestamp": "2024-01-15T10:30:00.123Z",
        "event": "session_started",
        "data": {}
      },
      {
        "timestamp": "2024-01-15T10:30:00.125Z",
        "event": "node_entered",
        "data": {"nodeId": "main_menu"}
      },
      {
        "timestamp": "2024-01-15T10:30:05.432Z",
        "event": "user_input",
        "data": {"input": "1"}
      }
    ]
  }
}
```

---

## Simulator

### Execute Flow

```bash
POST /api/simulator
```

Request:
```json
{
  "flowId": "flow_abc123",
  "phone": "+233201234567",
  "input": null
}
```

Response:
```json
{
  "success": true,
  "data": {
    "sessionId": "sim_abc123",
    "response": "Welcome!\n1. Check Balance\n2. Send Money",
    "continueSession": true,
    "currentNodeId": "main_menu",
    "variables": {}
  }
}
```

Continue session:
```json
{
  "flowId": "flow_abc123",
  "sessionId": "sim_abc123",
  "input": "1"
}
```

---

## Analytics

### Get Overview

```bash
GET /api/analytics/overview
```

Query parameters:

| Param | Type | Description |
|-------|------|-------------|
| `from` | datetime | Start date |
| `to` | datetime | End date |
| `instanceId` | string | Filter by instance |

Response:
```json
{
  "success": true,
  "data": {
    "totalSessions": 15420,
    "completedSessions": 12350,
    "avgDuration": 32500,
    "errorRate": 0.02,
    "topPaths": [
      {"path": "menu → balance → end", "count": 5420},
      {"path": "menu → transfer → confirm → end", "count": 3200}
    ]
  }
}
```

### Get Time Series

```bash
GET /api/analytics/timeseries
```

Query parameters:

| Param | Type | Description |
|-------|------|-------------|
| `from` | datetime | Start date |
| `to` | datetime | End date |
| `interval` | string | hour, day, week |
| `metric` | string | sessions, errors, duration |

Response:
```json
{
  "success": true,
  "data": [
    {"timestamp": "2024-01-15T00:00:00Z", "value": 1250},
    {"timestamp": "2024-01-15T01:00:00Z", "value": 980},
    {"timestamp": "2024-01-15T02:00:00Z", "value": 750}
  ]
}
```

---

## Error Codes

| Code | HTTP Status | Description |
|------|-------------|-------------|
| `VALIDATION_ERROR` | 400 | Invalid request data |
| `UNAUTHORIZED` | 401 | Missing or invalid auth |
| `FORBIDDEN` | 403 | Insufficient permissions |
| `NOT_FOUND` | 404 | Resource not found |
| `CONFLICT` | 409 | Resource already exists |
| `RATE_LIMITED` | 429 | Too many requests |
| `INTERNAL_ERROR` | 500 | Server error |

## Next Steps

<Cards>
  <Card title="Webhooks" icon="webhook" href="/engine/webhooks">
    Configure USSD callbacks
  </Card>
  <Card title="Self-Hosting" icon="server" href="/engine/self-hosting">
    Deploy your own instance
  </Card>
</Cards>
